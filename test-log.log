There is one test that I couldn't get to work, but I think I already took too much time to send this challenge back to you.
So I decided to send it anyway.